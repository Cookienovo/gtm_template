___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "displayName": "Cookienovo",
  "categories": [
    "TAG_MANAGEMENT",
    "UTILITY"
  ],
  "type": "TAG",
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "brand": {
    "id": "github.com_Cookienovo",
    "displayName": "Cookienovo",
    "thumbnail": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABgCAYAAADrc9dCAAAAxnpUWHRSYXcgcHJvZmlsZSB0eXBlIGV4aWYAAHjabVDbDcMgDPz3FB0BPzB4HPKo1A06fg04VRLlIg5zjs4P2L+fN7w6CAUkl6qmmhxiYtQ8qGmiDcYkgwdUIodXHTT0RC6x3zyfNRJ46Pg3mFfzKJ+M6hqJ5ZqwqEz1ZhSFuHdEHmxhZGHENBMYBq3FKFbLeYRlT1fUeaCTrmkMguF+f0vx7W3Z6zDRzsjJmVlnA9xPBm4esDOx+o/964oNLtGJL+RpTwfgB1BpWemP+Eq+AAABhGlDQ1BJQ0MgcHJvZmlsZQAAeJx9kT1Iw0AcxV9TpSIVBwt+4BChOtlFRRxLFYtgobQVWnUwufQLmjQkKS6OgmvBwY/FqoOLs64OroIg+AHiLjgpukiJ/0sKLWI8OO7Hu3uPu3eA0Kgw1eyKAqpmGal4TMzmVsXAK/wYxiACGJOYqSfSixl4jq97+Ph6F+FZ3uf+HH1K3mSATySOMt2wiDeIZzctnfM+cYiVJIX4nHjSoAsSP3JddvmNc9FhgWeGjExqnjhELBY7WO5gVjJU4hnisKJqlC9kXVY4b3FWKzXWuid/YTCvraS5TnMUcSwhgSREyKihjAosRGjVSDGRov2Yh3/E8SfJJZOrDEaOBVShQnL84H/wu1uzMD3lJgVjQPeLbX+MA4FdoFm37e9j226eAP5n4Epr+6sNYO6T9HpbCx8B/dvAxXVbk/eAyx1g6EmXDMmR/DSFQgF4P6NvygEDt0Dvmttbax+nD0CGulq+AQ4OgYkiZa97vLuns7d/z7T6+wGjynK653kz5QAADXZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+Cjx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDQuNC4wLUV4aXYyIj4KIDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+CiAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIgogICAgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIKICAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgIHhtbG5zOkdJTVA9Imh0dHA6Ly93d3cuZ2ltcC5vcmcveG1wLyIKICAgIHhtbG5zOnRpZmY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vdGlmZi8xLjAvIgogICAgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIgogICB4bXBNTTpEb2N1bWVudElEPSJnaW1wOmRvY2lkOmdpbXA6NmFhZGEyMDctMjIyMi00NzRmLWJiNzAtMmQxZDU3Yzc4ODAzIgogICB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOmU4OWZkZmY0LTJiMzMtNDNhZC1hZTkwLWZlM2E5NzE1NzhiMSIKICAgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOjgzYzQ2ODQyLTgzZmUtNDViZS1hOTc1LTRlYzk0YjdhM2EwMCIKICAgZGM6Rm9ybWF0PSJpbWFnZS9wbmciCiAgIEdJTVA6QVBJPSIyLjAiCiAgIEdJTVA6UGxhdGZvcm09IldpbmRvd3MiCiAgIEdJTVA6VGltZVN0YW1wPSIxNzQyOTQ0MTQ5OTYwMjk4IgogICBHSU1QOlZlcnNpb249IjIuMTAuMzYiCiAgIHRpZmY6T3JpZW50YXRpb249IjEiCiAgIHhtcDpDcmVhdG9yVG9vbD0iR0lNUCAyLjEwIgogICB4bXA6TWV0YWRhdGFEYXRlPSIyMDI1OjAzOjI2VDAwOjA5OjA3KzAxOjAwIgogICB4bXA6TW9kaWZ5RGF0ZT0iMjAyNTowMzoyNlQwMDowOTowNyswMTowMCI+CiAgIDx4bXBNTTpIaXN0b3J5PgogICAgPHJkZjpTZXE+CiAgICAgPHJkZjpsaQogICAgICBzdEV2dDphY3Rpb249InNhdmVkIgogICAgICBzdEV2dDpjaGFuZ2VkPSIvIgogICAgICBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOmU1NzBjZGFlLTIwNTktNDA3Ny1iZmE0LTZhOTMwYzdhMDA1NSIKICAgICAgc3RFdnQ6c29mdHdhcmVBZ2VudD0iR2ltcCAyLjEwIChXaW5kb3dzKSIKICAgICAgc3RFdnQ6d2hlbj0iMjAyNS0wMy0yNlQwMDowOTowOSIvPgogICAgPC9yZGY6U2VxPgogICA8L3htcE1NOkhpc3Rvcnk+CiAgPC9yZGY6RGVzY3JpcHRpb24+CiA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgCjw/eHBhY2tldCBlbmQ9InciPz5afAeDAAAABmJLR0QAAAAAAAD5Q7t/AAAACXBIWXMAABYlAAAWJQFJUiTwAAAAB3RJTUUH6QMZFwkJJlk0NwAAIABJREFUeNrtndlzXNl93z/nnLv13ujGDoIEwZ2cjZqhxjMjyRlJtiSvkaPIdsqVpeJKVSouV+WvyENeUq5KxZWHPNgVxS47sSVb44wteaTMaPad+wYuILGjAfR+t3PycBsAFxBAkyBnsU/VLbBI4vbt8/2t39/v/K4wxhge4dJaE2vDI/7YrpcQAiUFUspH+7mPChCtNdokQHzKsbgFlAQYKR4dMA8dEK0N2ujPFBD3BkYipfhsAmLM7VrxeVi3aosQnyFAtDbEWn9ugNjYvzwcbdlRQD6PWvGotcXaOTAMsTZorfmHsIwxxMZgACUFYodQ2REN+bybqEdpwuSnHgzRuT7pe2xpHTRaP/geWA8Gxs4neSKJMQnbbdq1BjqKQYDtuqTyWUQnH9jqM4UQxFFMu1YnCgIwYDk2Xi6Dcmww7Ohzr4ICD5azWA8Ght7R3CJs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\u003d"
  },
  "description": "Cookie banner (CMP) by Cookienovo\nhttps://cookienovo.com/",
  "containerContexts": [
    "WEB"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "TEXT",
    "name": "id",
    "displayName": "Site token",
    "simpleValueType": true,
    "alwaysInSummary": true,
    "valueValidators": [
      {
        "type": "NON_EMPTY"
      },
      {
        "type": "STRING_LENGTH",
        "args": [
          40,
          60
        ]
      }
    ],
    "clearOnCopy": true,
    "help": "Site token can be found in your Cookienovo"
  },
  {
    "type": "SELECT",
    "name": "consent_mode_enabled",
    "displayName": "Consent Mode v2",
    "macrosInSelect": false,
    "selectItems": [
      {
        "value": false,
        "displayValue": "Disabled"
      },
      {
        "value": true,
        "displayValue": "Enabled"
      }
    ],
    "simpleValueType": true,
    "alwaysInSummary": true,
    "defaultValue": true,
    "help": "If enabled, consent mode v2 will be supported. The default state will be set when the tag is loaded. If consent has been granted, consent update will also be called with the appropriate permissions."
  },
  {
    "type": "GROUP",
    "name": "default_consents",
    "displayName": "Default consent states",
    "groupStyle": "NO_ZIPPY",
    "subParams": [
      {
        "type": "SELECT",
        "name": "default_consent_functionality",
        "displayName": "Functionality",
        "macrosInSelect": false,
        "selectItems": [
          {
            "value": "denied",
            "displayValue": "denied"
          },
          {
            "value": "granted",
            "displayValue": "granted"
          }
        ],
        "simpleValueType": true,
        "defaultValue": "denied",
        "alwaysInSummary": true,
        "help": "Consent state for functionality_storage"
      },
      {
        "type": "SELECT",
        "name": "default_consent_marketing",
        "displayName": "Marketing",
        "macrosInSelect": false,
        "selectItems": [
          {
            "value": "denied",
            "displayValue": "denied"
          },
          {
            "value": "granted",
            "displayValue": "granted"
          }
        ],
        "simpleValueType": true,
        "defaultValue": "denied",
        "alwaysInSummary": true,
        "help": "Consent state for ad_storage, ad_personalization and ad_user_data"
      },
      {
        "type": "SELECT",
        "name": "default_consent_analytics",
        "displayName": "Analytics",
        "macrosInSelect": false,
        "selectItems": [
          {
            "value": "denied",
            "displayValue": "denied"
          },
          {
            "value": "granted",
            "displayValue": "granted"
          }
        ],
        "simpleValueType": true,
        "defaultValue": "denied",
        "alwaysInSummary": true,
        "help": "Consent state for analytics_storage"
      }
    ]
  },
  {
    "type": "GROUP",
    "name": "google_tag_configs",
    "displayName": "Google Tag Configs",
    "groupStyle": "ZIPPY_OPEN_ON_PARAM",
    "subParams": [
      {
        "type": "TEXT",
        "name": "wait_for_update",
        "displayName": "Wait for update",
        "simpleValueType": true,
        "defaultValue": 2000,
        "alwaysInSummary": true,
        "canBeEmptyString": false,
        "help": "When wait_for_update is set to some value, the tag will pause its execution until updated consent state is detected or timeout occurs. This helps ensure accurate consent-based behavior when tags fire before consent is captured.",
        "valueValidators": [
          {
            "type": "NON_NEGATIVE_NUMBER"
          }
        ],
        "valueHint": "2000",
        "valueUnit": "ms"
      },
      {
        "type": "SELECT",
        "name": "url_passthrough",
        "displayName": "URL passthrough",
        "macrosInSelect": true,
        "selectItems": [
          {
            "value": false,
            "displayValue": "false"
          },
          {
            "value": true,
            "displayValue": "true"
          }
        ],
        "simpleValueType": true,
        "defaultValue": false,
        "help": "When a visitor has cookies disabled (ad_storage or analytics_storage set to \u0027denied\u0027), URL passthrough can transmit ad click information and analytics data across pages using URL parameters."
      },
      {
        "type": "SELECT",
        "name": "ads_data_redaction",
        "displayName": "Google Ads Data Redaction",
        "macrosInSelect": true,
        "selectItems": [
          {
            "value": false,
            "displayValue": "false"
          },
          {
            "value": true,
            "displayValue": "true"
          }
        ],
        "simpleValueType": true,
        "help": "When ad_storage is denied, no new advertising cookies are set and existing third-party cookies from Google domains won\u0027t be used, though the full URL including ad click data will still be sent to Google. To further protect user privacy, enabling ads_data_redaction will redact ad click identifiers in network requests when ad_storage is denied.",
        "defaultValue": false
      },
      {
        "type": "PARAM_TABLE",
        "name": "region_specific",
        "displayName": "Region specific",
        "paramTableColumns": [
          {
            "param": {
              "type": "TEXT",
              "name": "region",
              "displayName": "Region",
              "simpleValueType": true,
              "valueValidators": [
                {
                  "type": "NON_EMPTY"
                }
              ],
              "help": "Code of region in ISO 3166-2 format, like \"US\", \"SK\", etc.",
              "valueHint": "ES,US-AK"
            },
            "isUnique": true
          },
          {
            "param": {
              "type": "SELECT",
              "name": "functionality",
              "displayName": "functional (functionality_storage)",
              "macrosInSelect": true,
              "selectItems": [
                {
                  "value": "denied",
                  "displayValue": "denied"
                },
                {
                  "value": "granted",
                  "displayValue": "granted"
                }
              ],
              "simpleValueType": true,
              "defaultValue": "denied",
              "help": "Default state of functionality_storage in given region"
            },
            "isUnique": false
          },
          {
            "param": {
              "type": "SELECT",
              "name": "analytics",
              "displayName": "analytics (analytics_storage)",
              "macrosInSelect": true,
              "selectItems": [
                {
                  "value": "denied",
                  "displayValue": "denied"
                },
                {
                  "value": "granted",
                  "displayValue": "granted"
                }
              ],
              "simpleValueType": true,
              "help": "Default state of analytics_storage in given region",
              "defaultValue": "denied"
            },
            "isUnique": false
          },
          {
            "param": {
              "type": "SELECT",
              "name": "marketing",
              "displayName": "marketing (ad_storage, ad_personalization, ad_user_data)",
              "macrosInSelect": true,
              "selectItems": [
                {
                  "value": "denied",
                  "displayValue": "denied"
                },
                {
                  "value": "granted",
                  "displayValue": "granted"
                }
              ],
              "simpleValueType": true,
              "defaultValue": "denied",
              "help": "Default state of ad_storage, ad_personalization and ad_user_data in given region"
            },
            "isUnique": false
          }
        ]
      }
    ]
  }
]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

// https://developers.google.com/tag-platform/tag-manager/templates/consent-apis
// https://developers.google.com/tag-platform/tag-manager/templates/api#injectscript

// https://cookienovo.com/app/sites/35be4000-6e4e-47f5-aa30-f29b03492afb
// https://kisk.sabatka.net/?dltype=gtm&gtmid=GTM-NM7B43FK

const log = require('logToConsole');
const setDefaultConsentState = require('setDefaultConsentState');
const updateConsentState = require('updateConsentState');
const getCookieValues = require('getCookieValues');
const injectScript = require('injectScript');
const Object = require('Object');
const gtagSet = require('gtagSet');
const createQueue = require('createQueue');
const setInWindow = require('setInWindow');


setInWindow('cookienovo_token', data.id, true);


function loadConsentFromCookie(consent) {
  var status = getCookieValues(consent);
  if (status.length === 0) return undefined;
  return (status[0] == 1) ? 'granted' : 'denied'; 
}



const defaultConsentState = {
  'ad_storage': data.default_consent_marketing,
  'ad_user_data': data.default_consent_marketing,
  'ad_personalization': data.default_consent_marketing,
  'analytics_storage': data.default_consent_analytics,
  'functionality_storage': data.default_consent_functionality,
//  'personalization_storage': data.default_consent_functionality,   // @TODO
//  'security_storage': data.default_consent_functionality,   // @TODO
  'wait_for_update': data.wait_for_update
};


if (data.consent_mode_enabled) {
  gtagSet('ads_data_redaction', data.ads_data_redaction);
  gtagSet('url_passthrough', data.url_passthrough);
  gtagSet('developer_id.dMjZhMT', true);
  log("Cookienovo: setting default state", defaultConsentState);
  setDefaultConsentState(defaultConsentState);

  data.region_specific = data.region_specific || [];
  for (let i = 0; i < data.region_specific.length; i++) {
    let rcs = data.region_specific[i];
    let regionConsentState = {
      'region': rcs.region.split(','),
      'ad_storage': rcs.marketing,
      'ad_user_data': rcs.marketing,
      'ad_personalization': rcs.marketing,
      'analytics_storage': rcs.analytics,
      'functionality_storage': rcs.functionality,
//    'personalization_storage': rcs.functionality,  // @TODO - toto dořešit
//    'security_storage': rcs.functionality,  // @TODO - toto dořešit
    };
    setDefaultConsentState(regionConsentState);
    log("Cookienovo: setting default state for region", regionConsentState);
  }
}



const cookienovoState = {
  'analytics': loadConsentFromCookie('cn-category-analytics'),
  'marketing': loadConsentFromCookie('cn-category-marketing'),
  'functionality': loadConsentFromCookie('cn-category-functional')
};
let updatedState = {};
if (cookienovoState.analytics !== undefined && cookienovoState.analytics !== data.default_consent_analytics) {
  updatedState.analytics_storage = cookienovoState.analytics;
}
if (cookienovoState.marketing !== undefined && cookienovoState.marketing !== data.default_consent_marketing) {
  updatedState.ad_storage = cookienovoState.marketing;
  updatedState.ad_user_data = cookienovoState.marketing;
  updatedState.ad_personalization = cookienovoState.marketing;
}
if (cookienovoState.functionality !== undefined && cookienovoState.functionality !== data.default_consent_functionality) {
  updatedState.functionality_storage = cookienovoState.functionality;
//  updatedState.personalization_storage = cookienovoState.functionality;
//  updatedState.security_storage = cookienovoState.functionality;
}
if (Object.keys(updatedState).length > 0) {
  log("Cookienovo: update consent mode with state", updatedState);
  if (data.consent_mode_enabled) {
    updateConsentState(updatedState);
  } else {
    const dataLayerPush = createQueue('dataLayer');
    dataLayerPush({
      'consent': updatedState,
      'event': 'cookie_consent_updated'
    });
  }
}


const url = 'https://cookienovo.com/assets/client.js';
injectScript(url, () => {
  log("Cookienovo: stript loaded", data);
  setInWindow('cookienovo_injected', true, true);
  data.gtmOnSuccess();
}, () => {
  log("Cookienovo: stript loading failed", data);
  data.gtmOnFailure();
});


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "logging",
        "versionId": "1"
      },
      "param": [
        {
          "key": "environments",
          "value": {
            "type": 1,
            "string": "debug"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "get_cookies",
        "versionId": "1"
      },
      "param": [
        {
          "key": "cookieAccess",
          "value": {
            "type": 1,
            "string": "specific"
          }
        },
        {
          "key": "cookieNames",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "cn-category-analytics"
              },
              {
                "type": 1,
                "string": "cn-category-functional"
              },
              {
                "type": 1,
                "string": "cn-category-marketing"
              },
              {
                "type": 1,
                "string": "cn-category-necessary"
              },
              {
                "type": 1,
                "string": "cn-consent-time"
              },
              {
                "type": 1,
                "string": "cn-dismissed"
              },
              {
                "type": 1,
                "string": "consent_cookies"
              },
              {
                "type": 1,
                "string": "cookienovolanguage"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "access_consent",
        "versionId": "1"
      },
      "param": [
        {
          "key": "consentTypes",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "ad_storage"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "ad_user_data"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "ad_personalization"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "analytics_storage"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "functionality_storage"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "personalization_storage"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "security_storage"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "wait_for_update"
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "url_passthrough"
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "region"
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "inject_script",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urls",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "https://cookienovo.com/assets/client.js"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "write_data_layer",
        "versionId": "1"
      },
      "param": [
        {
          "key": "keyPatterns",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "ads_data_redaction"
              },
              {
                "type": 1,
                "string": "url_passthrough"
              },
              {
                "type": 1,
                "string": "developer_id.dMjZhMT"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "access_globals",
        "versionId": "1"
      },
      "param": [
        {
          "key": "keys",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "cookienovo_token"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": false
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "cookienovo_injected"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": false
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___TESTS___

scenarios:
- name: Script was loaded
  code: |-
    runCode(mockData);
    assertApi('gtmOnSuccess').wasCalled();
- name: Token was set
  code: |-
    runCode(mockData);

    assertApi('setInWindow').wasCalledWith('cookienovo_token', '1234567890ABCDEF1234567890ABCDEF1234567890ABCDEF', true);
    // assertApi('setInWindow').wasCalledWith('cookienovo_injected', true, true);
- name: Default consent status was set
  code: |-
    runCode(mockData);
    assertApi('setDefaultConsentState').wasCalledWith({
      "ad_storage":"denied",
      "ad_user_data":"denied",
      "ad_personalization":"denied",
      "analytics_storage":"denied",
      "functionality_storage": "denied",
      "wait_for_update": 2000
    });
- name: Set Google configs
  code: |-
    runCode(mockData);
    assertApi('gtagSet').wasCalledWith('ads_data_redaction', false);
    assertApi('gtagSet').wasCalledWith('url_passthrough', true);
- name: Developer ID was set
  code: |-
    runCode(mockData);
    assertApi('gtagSet').wasCalledWith('developer_id.dMjZhMT', true);
- name: Consent was granted
  code: |-
    mock('getCookieValues', (name) => {
      switch (name) {
        case 'cn-category-analytics':
        case 'cn-category-functional':
        case 'cn-category-marketing':
          return ['1'];
      }
      return [];
    });

    runCode(mockData);

    assertApi('updateConsentState').wasCalledWith({
      "ad_storage":"granted",
      "ad_user_data":"granted",
      "ad_personalization":"granted",
      "analytics_storage":"granted",
      "functionality_storage": "granted"
    });
- name: Regional settings
  code: |-
    mockData.region_specific = [
      {"region":"SK","functionality":"granted","analytics":"denied","marketing":"denied"},
      {"region":"ES,PT","functionality":"granted","analytics":"granted","marketing":"denied"},
      {"region":"US-AS","functionality":"granted","analytics":"granted","marketing":"granted"}
    ];

    runCode(mockData);

    // default consent state
    assertApi('setDefaultConsentState').wasCalledWith({
      "ad_storage":"denied",
      "ad_user_data":"denied",
      "ad_personalization":"denied",
      "analytics_storage":"denied",
      "functionality_storage": "denied",
      "wait_for_update": 2000
    });

    assertApi('setDefaultConsentState').wasCalledWith({
      "ad_storage":"denied",
      "ad_user_data":"denied",
      "ad_personalization":"denied",
      "analytics_storage":"denied",
      "functionality_storage": "granted",
      "region": ["SK"]
    });


    assertApi('setDefaultConsentState').wasCalledWith({
      "ad_storage":"denied",
      "ad_user_data":"denied",
      "ad_personalization":"denied",
      "analytics_storage":"granted",
      "functionality_storage": "granted",
      "region": ["ES", "PT"]
    });

    assertApi('setDefaultConsentState').wasCalledWith({
      "ad_storage":"granted",
      "ad_user_data":"granted",
      "ad_personalization":"granted",
      "analytics_storage":"granted",
      "functionality_storage": "granted",
      "region": ["US-AS"]
    });
setup: |-
  let mockData = {
    'id': '1234567890ABCDEF1234567890ABCDEF1234567890ABCDEF',
    'consent_mode_enabled': true,
    'default_consent_functionality': 'denied',
    'default_consent_analytics': 'denied',
    'default_consent_marketing': 'denied',
    'wait_for_update': 2000,
    'ads_data_redaction': false,
    'url_passthrough': true,
  };

  let cookies = {};

  mock('injectScript', (url, onSuccess, onError) => {
    onSuccess();
  });

  mock('getCookieValues', (name) => {
    return [];
  });


___NOTES___

Created on 5. 3. 2025 20:59:32


